Rewrite and improve blacklist system
